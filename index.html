<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LIFF GAS æ¸¬è©¦</title>
<script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
<style>
body{font-family:"Microsoft JhengHei",sans-serif;text-align:center;padding:20px;}
button{padding:15px 30px;font-size:18px;margin:10px;cursor:pointer;}
#status{margin-top:20px;white-space:pre-wrap;}
</style>
</head>
<body>
<h2>LIFF GAS æ¸¬è©¦</h2>
<div id="profile">å–å¾— LINE è³‡æ–™ä¸­...</div>
<button onclick="testFetch()">æ¸¬è©¦ GAS é€£ç·š</button>
<div id="status"></div>

<script>
const LIFF_ID = "2008499706-eBayB9Yd"; // â† LIFF ID
const GAS_URL = "https://script.google.com/macros/s/AKfycbw9FozMxfpZ_wQdnE94cY0fDZPLQVoiE2yLDYLOymAv2VErzX49HMaf4MnHdUenL6lN/exec"; // â† æœ€æ–°éƒ¨ç½² Web App URL

let lineUserName = "";
async function initLIFF() {
  try {
    await liff.init({ liffId: LIFF_ID });
    if (!liff.isLoggedIn()) liff.login();
    const profile = await liff.getProfile();
    lineUserName = profile.displayName;
    document.getElementById("profile").innerText = `ğŸ‘¤ ${lineUserName} æ‚¨å¥½`;
  } catch(e) {
    document.getElementById("profile").innerText = "âŒ LIFF åˆå§‹åŒ–å¤±æ•—ï¼š" + e.message;
  }
}

async function testFetch() {
  document.getElementById("status").innerText = "â³ æ¸¬è©¦ä¸­...";
  try {
    const res = await fetch(GAS_URL, {
      method: "POST",
      headers: {"Content-Type": "application/json"},
      body: JSON.stringify({lineId:"test123", userName:lineUserName, message:"æ¸¬è©¦"})
    });
    const data = await res.json();
    document.getElementById("status").innerText = "âœ… å–å¾—å›æ‡‰ï¼š\n" + JSON.stringify(data,null,2);
  } catch(err) {
    document.getElementById("status").innerText = "âŒ è«‹æ±‚å¤±æ•—ï¼š" + err.message;
  }
}

initLIFF();
</script>
</body>
</html>

