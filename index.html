<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>å…¬å¸æ‰“å¡ç³»çµ± (LIFF)</title>
<script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
<style>
  body { font-family:"Microsoft JhengHei",sans-serif; background:#f6f7fb; text-align:center; margin:0; padding:20px;}
  .container { max-width:420px; margin:auto; padding:20px; background:#fff; border-radius:12px; box-shadow:0 4px 16px rgba(0,0,0,0.1);}
  h2 { color:#333; }
  button { width:100%; padding:15px; font-size:18px; margin:10px 0; border-radius:10px; border:none; cursor:pointer; color:white; font-weight:bold; }
  .btn-start { background:#28a745; } .btn-end { background:#dc3545; } .btn-search { background:#007bff; }
  #status { margin-top:20px; white-space:pre-wrap; color:#444; padding:10px; }
  #loading { display:none; margin-bottom:10px; font-size:16px; color:#555; }
</style>
</head>
<body>

<div class="container">
  <h2>å…¬å¸æ‰“å¡ç³»çµ±</h2>
  <div id="loading">â³ è³‡æ–™è¼‰å…¥ä¸­...</div>
  <div id="profile">æ­£åœ¨å–å¾— LINE ä½¿ç”¨è€…è³‡æ–™...</div>

  <button class="btn-start" onclick="send('ä¸Šç­')">ğŸŸ¢ ä¸Šç­</button>
  <button class="btn-end" onclick="send('ä¸‹ç­')">ğŸ”´ ä¸‹ç­</button>
  <button class="btn-search" onclick="send('æŸ¥è©¢')">ğŸ“‹ æŸ¥è©¢ä»Šæ—¥ç´€éŒ„</button>

  <div id="status"></div>
</div>

<script>
const LIFF_ID = "2008499706-eBayB9Yd";  // æ›¿æ›æˆä½ çš„ LIFF ID
const GAS_URL = "https://script.google.com/macros/s/AKfycbzBCdixzwg7v1DEDvyqJk2K9G408fIgJutOmr7hbAx15Yn7ymxR9BMlgGtEptENVvFP/exec"; // æ›¿æ›æˆä½ çš„ GAS URL

let lineUserId = "";
let lineUserName = "";

async function initLIFF() {
  try {
    await liff.init({ liffId: LIFF_ID });
    if (!liff.isLoggedIn()) liff.login();
    const profile = await liff.getProfile();
    lineUserId = profile.userId;
    lineUserName = profile.displayName;
    document.getElementById("profile").innerText =
      `ğŸ‘¤ ä½¿ç”¨è€…ï¼š${lineUserName}\nğŸ”‘ userIdï¼š${lineUserId}`;
  } catch (e) {
    document.getElementById("profile").innerText =
      "âŒ LIFF åˆå§‹åŒ–å¤±æ•—ï¼š\n" + e.message;
  }
}
initLIFF();

async function send(action) {
  if (!lineUserId) { alert("å°šæœªå–å¾— LINE userIdï¼Œè«‹é‡æ–°æ•´ç†"); return; }
  document.getElementById("loading").style.display = "block";

  const payload = { lineId: lineUserId, userName: lineUserName, message: action };

  try {
    const res = await fetch(GAS_URL, {
      method:"POST",
      headers:{ "Content-Type":"application/json" },
      body:JSON.stringify(payload)
    });
    const result = await res.json();
    document.getElementById("status").innerText = result.reply;
  } catch (err) {
    document.getElementById("status").innerText = "âŒ éŒ¯èª¤ï¼š\n" + err.message;
  }

  document.getElementById("loading").style.display = "none";
}
</script>

</body>
</html>


