<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>å…¬å¸æ‰“å¡ç³»çµ± (LIFF)</title>
<script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
<style>
body{font-family:"Microsoft JhengHei",sans-serif;background:#f6f7fb;padding:20px;text-align:center;}
.container{max-width:420px;margin:auto;padding:20px;background:#fff;border-radius:12px;box-shadow:0 4px 16px rgba(0,0,0,0.1);}
button{width:100%;padding:15px;margin:10px 0;border-radius:10px;border:none;font-size:18px;color:white;font-weight:bold;cursor:pointer;}
.btn-start{background:#28a745;}
.btn-end{background:#dc3545;}
.btn-search{background:#007bff;}
#status{margin-top:20px;white-space:pre-wrap;}
</style>
</head>
<body>
<div class="container">
<h2>å…¬å¸æ‰“å¡ç³»çµ±</h2>
<div id="profile">å–å¾— LINE ä½¿ç”¨è€…è³‡æ–™ä¸­...</div>
<button class="btn-start" onclick="send('ä¸Šç­')">ğŸŸ¢ ä¸Šç­</button>
<button class="btn-end" onclick="send('ä¸‹ç­')">ğŸ”´ ä¸‹ç­</button>
<button class="btn-search" onclick="send('æŸ¥è©¢')">ğŸ“‹ æŸ¥è©¢ä»Šæ—¥ç´€éŒ„</button>
<div id="status"></div>
</div>

<script>
const LIFF_ID = "2008499706-eBayB9Yd"; // â† æ›¿æ›ä½ çš„ LIFF ID
const GAS_URL = "https://script.google.com/macros/s/AKfycbyZUrwPFtQHwqGwPAvKJsfFJ7J2c4pYVxsmkJcH8S8eh3kjhWUt5RoXGspMPpiysQgg/exec"; // â† æ›¿æ› Web App URL

let lineUserId = "";
let lineUserName = "";

// åˆå§‹åŒ– LIFF
async function initLIFF(){
  try{
    await liff.init({liffId:LIFF_ID});
    if(!liff.isLoggedIn()){liff.login(); return;}
    const profile = await liff.getProfile();
    lineUserId = profile.userId;
    lineUserName = profile.displayName;
    document.getElementById("profile").innerText = `ğŸ‘¤ ${lineUserName}\nğŸ”‘ ${lineUserId}`;
  }catch(e){
    document.getElementById("profile").innerText = "âŒ LIFF åˆå§‹åŒ–å¤±æ•—ï¼š"+e.message;
  }
}
initLIFF();

// å‘¼å« GAS æ‰“å¡
async function send(action){
  if(!lineUserId){alert("å°šæœªå–å¾— LINE userId"); return;}
  document.getElementById("status").innerText = "â³ è«‹æ±‚ä¸­...";
  try{
    const res = await fetch(GAS_URL,{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({lineId:lineUserId,userName:lineUserName,message:action})
    });
    const data = await res.json();
    document.getElementById("status").innerText = "ğŸ“© å›æ‡‰ï¼š\n"+JSON.stringify(data,null,2);
  }catch(err){
    document.getElementById("status").innerText = "âŒ è«‹æ±‚éŒ¯èª¤ï¼š"+err.message;
  }
}
</script>
</body>
</html>






