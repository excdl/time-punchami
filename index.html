<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>LIFF 時間打卡範例</title>
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
</head>
<body>
  <h1>LIFF 時間打卡</h1>
  <button id="punchBtn">打卡</button>

  <script>
    const liffId = "2008504718-nmXP0WRV";  // 你自己的 LIFF ID
    const GAS_URL = "https://script.google.com/macros/s/AKfycbxeT7meD2V6-35YtkhRldOPMdadHzSdYaU4OnGU4-6NSWYpa3Hg4WG43plEXIl1Ky5R/exec";

    // 初始化 LIFF
    liff.init({ liffId })
      .then(() => {
        console.log("LIFF init success");
      })
      .catch(err => console.error("LIFF init failed", err));

    document.getElementById("punchBtn").addEventListener("click", async () => {
      const profile = await liff.getProfile();
      const now = new Date();
      const timeStr = now.getFullYear() + "-" +
                      String(now.getMonth()+1).padStart(2,'0') + "-" +
                      String(now.getDate()).padStart(2,'0') + " " +
                      String(now.getHours()).padStart(2,'0') + ":" +
                      String(now.getMinutes()).padStart(2,'0') + ":" +
                      String(now.getSeconds()).padStart(2,'0');

      const payload = {
        name: profile.displayName,
        time: timeStr
      };

      fetch(GAS_URL, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(payload)
      })
      .then(res => res.json())
      .then(data => {
        if(data.status === "ok") alert("打卡成功!");
        else alert("打卡失敗: " + JSON.stringify(data));
      })
      .catch(err => alert("網路錯誤: " + err));
    });
  </script>
</body>
</html>















